<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    .square {
      width: 50px;
      height: 50px;
      background-color: lightblue;
      display: inline-block;
      margin: 5px;
      cursor: pointer;
    }

    .selected {
      border: 2px solid red;
    }

    .colored {
      background-color: green;
    }

    #textInput {
      margin-top: 20px;
    }
  </style>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var squares = document.querySelectorAll('.square');
      var selectedSquare = null;

      squares.forEach(function (square, index) {
        square.addEventListener('click', function () {
          if (selectedSquare) {
            selectedSquare.classList.remove('selected');
          }
          selectedSquare = square;
          selectedSquare.classList.add('selected');
        });

        // Check local storage for color information on page load
        var storedColor = localStorage.getItem('squareColor' + index);
        if (storedColor) {
          square.style.backgroundColor = storedColor;
        }
      });

      var textInput = document.getElementById('textInput');
      var saveButton = document.getElementById('saveButton');
      var resetButton = document.getElementById('resetButton');

      saveButton.addEventListener('click', function () {
        if (selectedSquare) {
          var inputValue = textInput.value;
          if (inputValue === "9999") {
            selectedSquare.classList.add('colored'); // Add class to indicate color change
            textInput.value = ''; // Clear text input

            // Store color information in local storage
            var squareIndex = Array.from(squares).indexOf(selectedSquare);
            localStorage.setItem('squareColor' + squareIndex, 'green');
          }
        }
      });

      resetButton.addEventListener('click', function () {
        var inputValue = textInput.value;
        if (inputValue === "0000") {
          localStorage.clear(); // Reset local storage
          alert('ローカルストレージがリセットされました。');
          // Reset colors on all squares
          squares.forEach(function (square) {
            square.style.backgroundColor = 'lightblue';
          });
        }
      });
    });
  </script>
</head>
<body>
  <div class="square"></div>
  <div class="square"></div>
  <div class="square"></div>
  <div class="square"></div>
  <div class="square"></div>

  <div>
    <textarea id="textInput" rows="4" cols="50" placeholder="テキストを入力してください"></textarea>
    <button id="saveButton">保存</button>
    <button id="resetButton">消去</button>
  </div>
</body>
</html>
